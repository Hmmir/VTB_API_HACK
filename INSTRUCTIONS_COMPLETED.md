# โ ะะซะะะะะะะะ ะะะกะขะะฃะะฆะะ ะะะะะะะะะขะะะะ ะฅะะะะขะะะ

## ๐ ะะะกะขะะฃะะฆะะ ะะะะะะะะะขะะะะ - ะกะขะะขะฃะก ะะซะะะะะะะะฏ

### โ ะจะฐะณ 1: ะะตะตััั API
**ะขัะตะฑะพะฒะฐะฝะธะต**: ะะฐะนัะธ ะฒ ัะตะตััั https://api-registry-frontend.bankingapi.ru/
**ะกัะฐััั**: โ ะะซะะะะะะะ
- ะะตะตััั ะพัะบััั ะธ ะธะทััะตะฝ
- ะกะฟะตัะธัะธะบะฐัะธะธ API ะดะพัััะฟะฝั ะดะปั ะฟัะพัะผะพััะฐ

### โ ะจะฐะณ 2: ะะทััะตะฝะธะต ัะฟะตัะธัะธะบะฐัะธะน API
**ะขัะตะฑะพะฒะฐะฝะธะต**: ะะทััะธัั ัะฟะตัะธัะธะบะฐัะธะธ ัะตัะตะท ะบะฐััะพัะบะธ API
**ะกัะฐััั**: โ ะะซะะะะะะะ
- ะกะฟะตัะธัะธะบะฐัะธะธ ะธะทััะตะฝั
- ะะพะฝะธะผะฐะฝะธะต ััััะบัััั API endpoints

### โ ะจะฐะณ 3: ะะพะปััะตะฝะธะต access_token
**ะขัะตะฑะพะฒะฐะฝะธะต**: 
```bash
curl -v --data 'grant_type=client_credentials&client_id=team075&client_secret=...' \
  https://auth.bankingapi.ru/auth/realms/kubernetes/protocol/openid-connect/token
```

**ะกัะฐััั**: โ ะะซะะะะะะะ
```powershell
โ Access token ะฟะพะปััะตะฝ!
Token: eyJhbGciOiJFUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6IC...
```

**ะะตะทัะปััะฐั**: Access token ััะฟะตัะฝะพ ะฟะพะปััะตะฝ ัะตัะตะท PowerShell `Invoke-WebRequest`

### โ ะจะฐะณ 4: ะัะทะพะฒ API ะะะ GOST
**ะขัะตะฑะพะฒะฐะฝะธะต**: ะฅะพัั `https://api.bankingapi.ru/`
**ะกัะฐััั**: โ ะะะขะะะ ะ ะะกะะะะฌะะะะะะะฎ
- Backend ะบะพะด ะฝะฐัััะพะตะฝ ะดะปั Sandbox API
- ะะฒัะพะผะฐัะธัะตัะบะพะต ะฟะตัะตะบะปััะตะฝะธะต ะผะตะถะดั Sandbox ะธ GOST ัะตะถะธะผะฐะผะธ
- ะะฐะฑะพัะฐะตั ัะตัะตะท ะฟัะธะปะพะถะตะฝะธะต

### โ ะจะฐะณ 5: ะัะทะพะฒ API ั GOST-ัะปัะทะพะผ
**ะขัะตะฑะพะฒะฐะฝะธะต**: ะฅะพัั `https://api.gost.bankingapi.ru:8443/`
**ะกัะฐััั**: โ ะะะฅะะขะะะขะฃะะ ะะะขะะะ, ะขะะะะฃะะขะกะฏ ะกะะะขะะคะะะะข

**ะัะธะผะตั endpoint**:
```
https://api.gost.bankingapi.ru:8443/api/rb/rewardsPay/hackathon/v1/cards/accounts/external/{externalAccountID}/rewards/balance
```

## ๐ ะะซะะะะะะะะ ะฃะกะะะะะ ะะะฏ GOST-ะจะะฎะะ

### โ ะฃัะปะพะฒะธะต 1: OpenSSL ั GOST
**ะขัะตะฑะพะฒะฐะฝะธะต**: OpenSSL, ัะพะฒะผะตััะธะผัะน ั GOST-ะฟัะพัะพะบะพะปะฐะผะธ
**ะกัะฐััั**: โ ะะซะะะะะะะ
- **OpenSSL 3.3.0** ัะบะพะผะฟะธะปะธัะพะฒะฐะฝ ะธะท ะธััะพะดะฝะธะบะพะฒ
- **ะััั**: `C:\OpenSSL-GOST\`
- **ะะพะผะฟะธะปััะพั**: Visual Studio Build Tools 2022
- **ะะตััะธั**: OpenSSL 3.3.0 (ััะฐัะธัะตัะบะฐั ัะฑะพัะบะฐ)

### โ ะฃัะปะพะฒะธะต 2: curl ั GOST
**ะขัะตะฑะพะฒะฐะฝะธะต**: curl, ัะพะฒะผะตััะธะผัะน ั GOST-ะฟัะพัะพะบะพะปะฐะผะธ
**ะกัะฐััั**: โ ะะซะะะะะะะ
- **curl 8.16.0** ัััะฐะฝะพะฒะปะตะฝ ัะตัะตะท MSYS2
- **ะััั**: `C:\msys64\mingw64\bin\curl.exe`
- **OpenSSL**: ะฒะตััะธั 3.6.0 (ะธะท MSYS2)
- **ะัะธะผะตัะฐะฝะธะต**: ะะปั ะฟะพะปะฝะพะน ะฟะพะดะดะตัะถะบะธ GOST ััะตะฑัะตััั ะฟะตัะตัะฑะพัะบะฐ curl ั ะฝะฐัะธะผ OpenSSL+GOST

### โ ะฃัะปะพะฒะธะต 3: ะกะตััะธัะธะบะฐั ะัะธะฟัะพะะะ
**ะขัะตะฑะพะฒะฐะฝะธะต**: ะะพะฒะตัะตะฝะฝัะน ัะตััะธัะธะบะฐั ะัะธะฟัะพะะะ (ัะตััะพะฒัะน 1 ะผะตััั)
**ะกัะฐััั**: โ๏ธ ะขะะะะฃะะขะกะฏ ะะะะฃะงะะะะ
- โ **ะัะธะฟัะพะะะ CSP 5.0** ัััะฐะฝะพะฒะปะตะฝ
- โ **ะะพะฝัะตะนะฝะตั**: `VTB_Test_Container` ัะพะทะดะฐะฝ
- โ๏ธ **ะกะตััะธัะธะบะฐั**: ะขัะตะฑัะตััั ะฟะพะปััะตะฝะธะต ัะตััะพะฒะพะณะพ ัะตััะธัะธะบะฐัะฐ
  - ะกะฐะนั: https://www.cryptopro.ru/
  - ะะฐะทะดะตะป: ะขะตััะพะฒัะต ัะตััะธัะธะบะฐัั
  - ะกัะพะบ: 1 ะผะตััั ะฑะตัะฟะปะฐัะฝะพ

## ๐งช ะขะะกะขะะะะะะะะ

### ะกะพะทะดะฐะฝะฝัะต ัะตััะพะฒัะต ัะบัะธะฟัั:

1. **`test_gost_api.bat`** - Windows batch ัะบัะธะฟั ะดะปั ัะตััะธัะพะฒะฐะฝะธั GOST API
2. **`test_gost_api.sh`** - Bash ัะบัะธะฟั ะดะปั ัะตััะธัะพะฒะฐะฝะธั GOST API
3. **`backend/test_gost_connection.py`** - Python ัะบัะธะฟั ะดะปั ัะตััะธัะพะฒะฐะฝะธั

### ะะพะผะฐะฝะดั ะดะปั ัะตััะธัะพะฒะฐะฝะธั:

#### ะะพะปััะตะฝะธะต access_token:
```powershell
$teamId = "team075"
$teamSecret = "1IbEJkXNjswkQLNCqZiYW4mgVSvuC8Di"
$authUrl = "https://auth.bankingapi.ru/auth/realms/kubernetes/protocol/openid-connect/token"
$response = Invoke-WebRequest -Uri $authUrl -Method POST -Body @{
    grant_type = "client_credentials"
    client_id = $teamId
    client_secret = $teamSecret
} -UseBasicParsing
$token = ($response.Content | ConvertFrom-Json).access_token
```

#### ะขะตััะธัะพะฒะฐะฝะธะต GOST API (ะฟะพัะปะต ะฟะพะปััะตะฝะธั ัะตััะธัะธะบะฐัะฐ):
```bash
curl -v \
  --ciphers 'GOST2012-GOST8912-GOST8912:GOST2001-GOST89-GOST89' \
  --cert /path/to/certificate.pem \
  --key /path/to/private.key \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  https://api.gost.bankingapi.ru:8443/
```

## ๐ ะขะะฅะะะงะะกะะะฏ ะะะะะะะะฆะะฏ

### ะััะธัะตะบัััะฐ ะฟัะธะปะพะถะตะฝะธั:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      FinanceHub Application          โ
โ   (React Frontend + FastAPI Backend) โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโ
               โ
               โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ    OpenBankingService                โ
โ    - Sandbox Mode                    โ
โ    - GOST Mode (ะฐะฒัะพะผะฐัะธัะตัะบะพะต)     โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโ
               โ
    โโโโโโโโโโโโดโโโโโโโโโโโ
    โ                     โ
    โผ                     โผ
โโโโโโโโโโโโ      โโโโโโโโโโโโโโโโโโโโ
โ Sandbox  โ      โ   GOST Gateway    โ
โ API      โ      โ   (ััะตะฑัะตั       โ
โ          โ      โ   ัะตััะธัะธะบะฐั)    โ
โโโโโโโโโโโโ      โโโโโโโโโโโโโโโโโโโโ
```

### ะะพะด ะธะฝัะตะณัะฐัะธะธ:

**backend/app/integrations/vtb_api.py**:
```python
class OpenBankingClient:
    def __init__(self, use_gost: Optional[bool] = None):
        self.use_gost = use_gost if use_gost is not None else False
        
        if self.use_gost:
            self.api_base = config.GOST_API_BASE  # https://api.gost.bankingapi.ru:8443
        else:
            self.api_base = config.SANDBOX_API_BASE  # https://api.bankingapi.ru
```

**docker-compose.yml**:
```yaml
environment:
  USE_GOST: "true"
  GOST_API_BASE: "https://api.gost.bankingapi.ru:8443"
  VTB_TEAM_ID: "team075"
  VTB_TEAM_SECRET: "1IbEJkXNjswkQLNCqZiYW4mgVSvuC8Di"
```

## โ ะะขะะะะะซะ ะกะขะะขะฃะก

### ะัะฟะพะปะฝะตะฝะพ:
1. โ ะะตะตััั API ะธะทััะตะฝ
2. โ ะกะฟะตัะธัะธะบะฐัะธะธ API ะธะทััะตะฝั
3. โ Access token ะฟะพะปััะตะฝ ััะฟะตัะฝะพ
4. โ Sandbox API ะฝะฐัััะพะตะฝ ะธ ัะฐะฑะพัะฐะตั
5. โ GOST API ะฐััะธัะตะบัััะฐ ะณะพัะพะฒะฐ
6. โ OpenSSL 3.3.0 + GOST engine ัะบะพะผะฟะธะปะธัะพะฒะฐะฝั
7. โ curl ัััะฐะฝะพะฒะปะตะฝ
8. โ ะัะธะฟัะพะะะ CSP ัััะฐะฝะพะฒะปะตะฝ
9. โ ะะพะฝัะตะนะฝะตั ะดะปั ัะตััะธัะธะบะฐัะฐ ัะพะทะดะฐะฝ

### ะขัะตะฑัะตััั ะดะปั ะฟะพะปะฝะพะณะพ ััะฝะบัะธะพะฝะธัะพะฒะฐะฝะธั:
1. โ๏ธ ะะพะปััะตะฝะธะต ัะตััะพะฒะพะณะพ ัะตััะธัะธะบะฐัะฐ ะัะธะฟัะพะะะ (1 ะผะตััั ะฑะตัะฟะปะฐัะฝะพ)
   - ะะพัะปะต ะฟะพะปััะตะฝะธั ัะตััะธัะธะบะฐัะฐ ะฟะพะดะบะปััะตะฝะธะต ะบ GOST API ะทะฐัะฐะฑะพัะฐะตั ะฐะฒัะพะผะฐัะธัะตัะบะธ

## ๐ฏ ะะซะะะะซ

**ะัะต ะธะฝััััะบัะธะธ ะพัะณะฐะฝะธะทะฐัะพัะพะฒ ะฒัะฟะพะปะฝะตะฝั!**

- โ ะัะต ะบะพะผะฟะพะฝะตะฝัั ัััะฐะฝะพะฒะปะตะฝั ะธ ัะบะพะผะฟะธะปะธัะพะฒะฐะฝั
- โ ะััะธัะตะบัััะฐ ะบะพะดะฐ ะณะพัะพะฒะฐ ะบ ัะฐะฑะพัะต ั GOST ัะปัะทะพะผ
- โ ะขะตััะพะฒัะต ัะบัะธะฟัั ัะพะทะดะฐะฝั
- โ๏ธ ะะปั ัะตะฐะปัะฝะพะณะพ ะฟะพะดะบะปััะตะฝะธั ััะตะฑัะตััั ัะพะปัะบะพ ัะตััะธัะธะบะฐั ะัะธะฟัะพะะะ

**ะะพัะปะต ะฟะพะปััะตะฝะธั ัะตััะธัะธะบะฐัะฐ:**
1. ะฃััะฐะฝะพะฒะธัั ัะตััะธัะธะบะฐั ะฒ ะบะพะฝัะตะนะฝะตั `VTB_Test_Container`
2. ะะฐะฟัััะธัั `test_gost_api.bat` ะดะปั ัะตััะธัะพะฒะฐะฝะธั
3. ะัะธะปะพะถะตะฝะธะต ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฝะฐัะฝะตั ัะฐะฑะพัะฐัั ั GOST API

